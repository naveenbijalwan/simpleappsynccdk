# Simple Appsync CDK stack

This an example of an AppSync GraphQL API, pointing to four resolvers doing CRUD operations with a single DynamoDB table.

## Build

To build this app, you need to be in this example's root folder. Then run the following:

```bash
npm install -g aws-cdk
npm install
npm run build
```

This will install the necessary CDK, then this example's dependencies, and then build your TypeScript files and your CloudFormation template.

## Deploy

Run `cdk deploy`. This will deploy / redeploy your Stack to your AWS Account.

![alt text](https://github.com/naveenbijalwan/simpleappsynccdk/blob/main/cdkdeploy.PNG?raw=true)

After the deployment you will see the API's URL, which represents the url you can then use.

![alt text](https://github.com/naveenbijalwan/simpleappsynccdk/blob/main/apisurl.PNG?raw=true)

and DynamoDB table:

![alt text](https://github.com/naveenbijalwan/simpleappsynccdk/blob/main/dynamodbtable.PNG?raw=true)

## Synthesize Cloudformation Template

To see the Cloudformation template generated by the CDK, run `cdk synth`, then check the output file in the "cdk.out" directory.

## The Component Structure

This Stack contains:

- a __GraphQL API__ with an API Key (Use with caution, each key is only valid for 7 days.)
- a __GraphQL Schema__ with Queries to get one and all items and two mutations to save and delete an item
- a __DynamoDB table__ `items` that stores the data with a Pay Per Request Billing Mode
- an __IAM Role__ that allows AppSync to invoke your DynamoDB table.
- an __AppSync DataSource__, connecting your API to the DynamoDB table with the previously specified role.
- a __AppSync Resolver__ for a Query `getOne` to get one item from the DynamoDB table.
- a __AppSync Resolver__ for a Query `all` to get all items from the DynamoDB table.
- a __AppSync Resolver__ for a Mutation `save` to put an item into the DynamoDB table (the id is autogenerated, you need only name).
- a __AppSync Resolver__ for a Mutation `delete` to delete one item from the DynamoDB table.
